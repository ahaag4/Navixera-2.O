<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Live Public Transit Dashboard — Navixera</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">

  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
  
  <link rel="stylesheet" href="bus.css">
</head>
<body>
  <nav class="navbar navbar-expand-lg shadow-sm">
    <div class="container">
      <a class="navbar-brand" href="#">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-broadcast-pin" viewBox="0 0 16 16" style="margin-right: 8px;">
          <path d="M3.05 3.05a7 7 0 0 0 0 9.9.5.5 0 0 1-.707.707 8 8 0 0 1 0-11.314.5.5 0 0 1 .707.707zm2.122 2.122a4 4 0 0 0 0 5.656.5.5 0 1 1-.708.708 5 5 0 0 1 0-7.072.5.5 0 0 1 .708.708zm5.656-.708a.5.5 0 0 1 .708 0 5 5 0 0 1 0 7.072.5.5 0 1 1-.708-.708 4 4 0 0 0 0-5.656.5.5 0 0 1 0-.708zm2.122-2.12a.5.5 0 0 1 .707 0 8 8 0 0 1 0 11.314.5.5 0 0 1-.707-.707 7 7 0 0 0 0-9.9.5.5 0 0 1 0-.707zM8 10a2 2 0 1 1 0-4 2 2 0 0 1 0 4z"/>
          <path d="M12.06 13.94a.5.5 0 0 1 .707 0l1.414 1.414a.5.5 0 0 1-.707.707L12.06 14.647a.5.5 0 0 1 0-.707zM4.646 13.94a.5.5 0 0 0-.707 0L2.525 15.354a.5.5 0 0 0 .707.707L4.646 14.647a.5.5 0 0 0 0-.707zM8 16s6-5.686 6-10A6 6 0 0 0 2 6c0 4.314 6 10 6 10zM8 9a3 3 0 1 1 0-6 3 3 0 0 1 0 6z"/>
        </svg>
        Navixera — Live Transit
      </a>
      <div class="d-flex align-items-center">
        <span class="badge bg-primary me-2">Live</span>
        <small class="text-muted d-none d-md-block">AI-Powered Transit Tracking</small>
      </div>
    </div>
  </nav>

  <main class="container my-4">
    <div class="row g-4">
      <div class="col-12 col-lg-8">
        <div class="card map-card">
          <div id="map"></div>
          <div class="map-controls">
            <button id="locateBtn" class="btn btn-light" title="Find My Location">
              <i class="bi bi-geo-alt-fill text-primary"></i>
            </button>
            <button id="showBusStopsBtn" class="btn btn-light" title="Show Bus Stops">
              <i class="bi bi-signpost text-primary"></i>
            </button>
            <button id="lostBagBtn" class="btn btn-light" title="Report Lost Bag" data-bs-toggle="modal" data-bs-target="#lostBagModal">
              <i class="bi bi-bag-x text-danger"></i>
            </button>
          </div>
          <div class="loader-overlay" id="loader">
            <div class="spinner-border text-primary" role="status">
              <span class="visually-hidden">Loading...</span>
            </div>
          </div>
        </div>
      </div>
      <div class="col-12 col-lg-4">
        <div class="card search-panel">
          <h5 class="card-title mb-3">Find Your Ride</h5>
          <div class="search-group">
            <label for="searchVehicle" class="form-label fw-medium">Vehicle Number</label>
            <input type="text" id="searchVehicle" class="form-control" placeholder="e.g., MH-01-AB-1234">
            <button id="searchVehicleBtn" class="btn btn-primary w-100 mt-2">
              <i class="bi bi-search"></i> Search Vehicle
            </button>
          </div>
          <div class="divider"></div>
          <div class="search-group">
            <label for="searchRouteFrom" class="form-label fw-medium">Route Planner</label>
            <input type="text" id="searchRouteFrom" class="form-control" placeholder="From (e.g., Central Station)">
            <input type="text" id="searchRouteTo" class="form-control mt-2" placeholder="To (e.g., North Park)">
            <button id="searchRouteBtn" class="btn btn-primary w-100 mt-2">
              <i class="bi bi-signpost-split"></i> Find Route
            </button>
          </div>
          
          <!-- Bus Alert Section -->
          <div class="divider"></div>
          <div class="search-group">
            <label class="form-label fw-medium">Bus Arrival Alerts</label>
            <select id="busAlertSelect" class="form-select">
              <option value="">Select a bus to track</option>
            </select>
            <button id="setAlertBtn" class="btn btn-warning w-100 mt-2">
              <i class="bi bi-bell"></i> Set Arrival Alert
            </button>
          </div>
          
          <div class="mt-auto">
            <h6 class="fw-medium mb-2">Search Results</h6>
            <div class="result-list" id="searchResults">
              <div class="text-center p-3 text-muted">
                <i class="bi bi-inbox d-block fs-1 mb-2"></i>
                <span>Your search results will appear here</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>

  <div class="card sidebar" id="vehicleDetails">
    <div class="card-header d-flex justify-content-between align-items-center">
      <h5 class="card-title mb-0" id="vehicleTitle">Vehicle Details</h5>
      <button type="button" class="btn-close" aria-label="Close" id="closeSidebarBtn"></button>
    </div>
    <div class="card-body">
      <div id="vehicleInfo" class="mb-3"></div>
      <h6 class="fw-medium mb-3">Route Stops</h6>
      <ul id="stopList" class="list-group list-group-flush"></ul>
    </div>
  </div>

  <div class="card bus-stop-panel" id="busStopPanel">
    <div class="card-header d-flex justify-content-between align-items-center">
      <h5 class="card-title mb-0">Nearest Bus Stop</h5>
      <button type="button" class="btn-close" aria-label="Close" id="closeBusStopPanelBtn"></button>
    </div>
    <div class="card-body" id="busStopContent">
      <!-- Dynamically populated -->
    </div>
  </div>

  <!-- Lost Bag Modal -->
  <div class="modal fade" id="lostBagModal" tabindex="-1" aria-labelledby="lostBagModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="lostBagModalLabel">Report Lost Bag</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <p>If you've forgotten your bag on a bus, we can notify the driver. This only works when you're near the bus.</p>
          <div class="mb-3">
            <label for="lostBagBusSelect" class="form-label">Select Bus</label>
            <select class="form-select" id="lostBagBusSelect">
              <option value="">Select the bus you were on</option>
            </select>
          </div>
          <div class="mb-3">
            <label for="bagDescription" class="form-label">Bag Description</label>
            <textarea class="form-control" id="bagDescription" rows="3" placeholder="Describe your bag (color, size, distinctive features)"></textarea>
          </div>
          <div class="form-check mb-3">
            <input class="form-check-input" type="checkbox" id="confirmLocation">
            <label class="form-check-label" for="confirmLocation">
              I confirm I'm currently near this bus
            </label>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-danger" id="reportLostBagBtn">Report Lost Bag</button>
        </div>
      </div>
    </div>
  </div>

  <div class="toast-container"></div>

  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-functions-compat.js"></script>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
  <script src="https://cdn.jsdelivr.net/npm/leaflet-rotatedmarker@0.2.0/leaflet.rotatedMarker.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>

  <script src="bus.js"></script>
</body>
  </html>
